# Default value referencing non-values context object produces spurious warnings.
# https://github.com/cue-exp/helm2cue/issues/33
exec helm2cue chart chartdir outdir
cmp stderr stderr.golden
cmp outdir/values.cue expected/values.cue

-- chartdir/Chart.yaml --
apiVersion: v2
name: test-app
version: 0.1.0
-- chartdir/values.yaml --
nameOverride: ""
-- chartdir/templates/test.yaml --
name: {{ default .Chart.Name .Values.nameOverride }}
-- stderr.golden --
warning: values schema inconsistency: #values.nameOverride: reference "#chart" not found
warning: values.yaml does not satisfy inferred schema: #values.nameOverride: reference "#chart" not found
converted 1/1 templates from test-app
-- expected/values.cue --
// Code generated by helm2cue; DO NOT EDIT.

package test_app

#values: {
	nameOverride: *#chart.Name | bool | number | string | null
	...
}
